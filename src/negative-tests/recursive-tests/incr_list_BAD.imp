mk_list(v) {
  if _ then null else {
    let v2 = mkref v in
    {
      if v > 3 then {
         ()
      }else{
         v2 := v + 1; };
      let nxt = mk_list(*v2) in
      mkref (v,nxt)
    }
  }
}

verify_incr(p, idx) {
  ifnull p then ()
  else {
    let (v, next) = *p in {
      assert(v = idx);
      verify_incr(next, (idx + 1))
    }
  }
}

{
 let n = mk_list(0) in
 verify_incr(n, 0)
}
