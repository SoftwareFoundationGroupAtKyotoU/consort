/*
    VERIFIED
    0.28s user 0.12s system 0% cpu 3:16.17 total
*/

create_tree(v) {
    mkref (v, null, null)
}

insert_val(t, v) {
    ifnull t then 
        ()
    else
        let (curr, l, r) = *t in {
        if v < curr then 
            ifnull l then
                t := (curr, mkref (v, null, null), r)
            else {
                insert_val(l, v);
                alias(l = (*t).1);
                alias(r = (*t).2)
            }
        else 
            ifnull r then
                t := (curr, l, mkref (v, null, null))
            else {
                insert_val(r, v);
                alias(l = (*t).1);
                alias(r = (*t).2)
            }
        }
}

verify_tree(t) {
    ifnull t then 
        ()
    else
        let (v, l, r) = *t in 
        {
            ifnull l then 
                ()
            else
                let (vl, _, _) = *l in {
                    assert(vl < v);
                    verify_tree(l)
                };
            ifnull r then 
                ()
            else
                let (vr, _, _) = *r in {
                    assert(vr >= v);
                    verify_tree(r)
                }
        }
}

{
    let t = create_tree(_) in {
        insert_val(t, _);
        verify_tree(t)
    }
}