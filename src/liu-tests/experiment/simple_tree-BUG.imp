/*
    UNVERIFIED (unsafe)
    1.84s user 0.28s system 85% cpu 2.465 total
*/

create_tree() {
    mkref (5, mkref(9, null, null), mkref (1, null, null))
}

verify_tree(t) {
    ifnull t then 
        ()
    else
        let (v, l, r) = *t in 
        {
            ifnull l then 
                ()
            else
                let (vl, _, _) = *l in {
                    assert(vl < v);
                    verify_tree(l)
                };
            ifnull r then 
                ()
            else
                let (vr, _, _) = *r in {
                    assert(vr <= v);
                    verify_tree(r)
                }
        }
}

{
    let t = create_tree() in {
        verify_tree(t)
    }
}

